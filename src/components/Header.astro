---
import { t } from "../utils/i18n";

interface Props {
  lang: string;
}

const { lang } = Astro.props as Props;
---

<header class="flex justify-between items-center bg-white rounded-lg shadow dark:bg-black-800 py-4 w-full xl:w-[1120px] mx-auto">
  <img
    class="rounded-full size-10 mb-2 ml-6"
    src="https://avatars.githubusercontent.com/u/30017498?s=400&u=ad3e2a3e5830149a0cfed96c02cc5e649e60dde5&v=4"
    alt="maccari78 photo"
  />
  <nav class="flex flex-row gap-x-10 opacity-90 mr-6">
    <a href="#top">{t("header.home", lang)}</a>
    <a href="#experiencia">{t("header.experience", lang)}</a>
    <a href="#proyectos">{t("header.projects", lang)}</a>
    <select id="language-select" value={lang} class="ml-4">
      <option value="es">ES</option>
      <option value="en">EN</option>
    </select>
  </nav>
</header>

<script>
  if (typeof window !== 'undefined') {
    const languageSelect = document.getElementById('language-select') as HTMLSelectElement | null;
    if (languageSelect) {
      languageSelect.value = new URLSearchParams(window.location.search).get('lang') || localStorage.getItem('language') || 'es';

      languageSelect.addEventListener('change', function(event) {
        const target = event.target as HTMLSelectElement;
        const newLang = target.value;
        localStorage.setItem('language', newLang); 
        window.location.href = `${window.location.pathname}?lang=${newLang}`; 
      });
    }
  }
</script>
